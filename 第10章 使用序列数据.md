# <div align = right>第十章</div>
-------
# <div align = right>使用序列数据</div>

> 生物信息学的核心问题之一是处理大量的（通常定义糟糕或模糊）文件格式。久而久之，一些特定的简单的人类可读的格式成为了事实上的标准。
> <div align = right>- 彼得·科克等，2010年</div>
> 好的程序员知道怎样写程序。杰出的程序员知道怎样重写（并重新使用）。
> <div align = right>- 《大教堂和集市》 埃里克·斯蒂芬·雷蒙德</div>

在生物信息学中，核苷酸（和蛋白质）序列普遍以两种纯文本格式存储：FASTA和FASTQ，发音分别为fast-ah（或fast-A）和fast-Q。 我们将在本节讨论这两种格式和它们各自的局限性，然后了解一些处理这些数据格式的工具。这是一个简短的章节，但是本节有一个重要的事项需要注意，也就是处理这些特定生物信息学格式的共同误区。即使像文件格式这样的细枝末节中存在的简单错误，也需要很多时间和精力去发现和修复，所以请尽早记住这些细节。

## FASTA格式
FASTA格式源于由William R. Pearson和David J. Lipman开发的FASTA比对套装软件。FASTA格式用于存储各种序列数据，不需要每个碱基对的质量分数。这些序列数据包括参考基因组文件，蛋白质序列，DNA编码序列（CDS），转录本序列等。FASTA也可以用来存储多序列比对数据，但是我们这里不会讨论这个FASTA的格式的特殊变体。我们在前面的章节遇到了FASTA格式，但在本节中，我们将详细介绍这种格式，了解该格式常见的缺陷，并介绍一些处理这种格式的工具。
FASTA文件由序列条目组成，每个条目都包含两部分内容：序列描述和序列数据。描述行以一个大于号（>）开始，包含序列标识符和其他（可选）信息。 序列数据从描述行的下一行开始，直到另一个描述行（以 > 开头的行）出现或文件结束。 本章GitHub目录中的*egfr_ FL ank.fasta*文件是一个FASTA例子文件：
```
$ head -10 egfr_flank.fasta
> ENSMUSG00000020122 | ENSMUST00000138518
CCCTCCTATCATGCTGTCAGTGTATCTCTAAATAGCACTCTCAACCCCCGTGAACTTGGT
TATTAAAAACATGCCCAAAGTCTGGGAGCCAGGGCTGCAGGGAAATACCACAGCCTCAGT
TCATCAAAACAGTTCATTGCCCAAAATGTTCTCAGCTGCAGCTTTCATGAGGTAACTCCA
GGGCCCACCTGTTCTCTGGT 
> ENSMUSG00000020122 | ENSMUST00000125984
GAGTCAGGTTGAAGCTGCCCTGAACACTACAGAGAAGAGAGGCCTTGGTGTCCTGTTGTC
TCCAGAACCCCAATATGTCTTGTGAAGGGCACACAACCCCTCAAAGGGGTGTCACTTCTT
CTGATCACTTTTGTTACTGTTTACTAACTGATCCTATGAATCACTGTGTCTTCTCAGAGG
CCGTGAACCACGTCTGCAAT
```
FASTA格式的简单性和灵活性却带来了令人遗憾的缺点：FASTA格式是一个松散定义的特殊格式（虽然这种现象在生物信息学中十分常见）。因此，你可能会遇到FASTA格式的各种变体，这些变体会造成微小的错误，除非你的程序足够强大。这就是为什么最好使用现有的FASTA / FASTQ解析库而不是执行自定义的解析库；现有的库已经过开源社区审查（后续将更多讨论这一部分内容）。
  
关于FASTA格式最令人头疼的是描述行中标识符的格式没有通用的规范。例如，如下FASTA描述行是否指代同一条目？ 
```
>ENSMUSG00000020122|ENSMUST00000138518
> ENSMUSG00000020122|ENSMUST00000125984
>ENSMUSG00000020122|ENSMUST00000125984|epidermal growth factor receptor
>ENSMUSG00000020122|ENSMUST00000125984|Egfr
>ENSMUSG00000020122|ENSMUST00000125984|11|ENSFM00410000138465
```
没有标识符的标准方案，我们不能使用简单的精确匹配确定一个标识符是否和FASTA条目的标题行匹配。相反，我们需要依靠FASTA文件描述行和标识符之间的模糊匹配。这可能会使得判断标准变得相当凌乱：匹配模式的宽容度应该是多少？如果正则表达式过于宽泛是否会匹配到错误的序列？基本上来说，模糊匹配是一个脆弱的策略。

幸运的是，这个问题有更好的解决方案（也很简单）：与其事后依靠模糊匹配来纠正不一致的命名，还不如一开始就拥有严格的命名规范并始终保持一致。然后，在运行任何外部来源的数据时，需要通过几个合理性检查，以确保数据遵循对应的格式。 这些检查不需要太复杂（检查重复的名称，手动检查一些条目，检查 > 和标识符之间错误的空格，检查不同文件之间名字的重合等）。
